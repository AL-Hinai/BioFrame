# Phylogenomics Gene Recovery Pipeline
# Based on PhylogenomicsPipelines recover_genes_from_all_samples.sh

workflow_name: "Phylogenomics Gene Recovery Pipeline"
workflow_description: "Extract genes from Illumina sequencing data using Paftools or HybPiper"
workflow_version: "1.0"
workflow_author: "BioFrame Team"
workflow_category: "Gene Recovery"

# Pipeline steps
steps:
  - step_number: 1
    step_name: "Quality Control"
    tool_name: "trimmomatic"
    description: "Quality trimming of raw sequencing reads"
    input_types: ["FASTQ"]
    output_types: ["FASTQ"]
    parameters:
      mode: "PE"
      trimming_options: ["ILLUMINACLIP:/adapters/TruSeq3-PE.fa:2:30:10", "LEADING:3", "TRAILING:3", "SLIDINGWINDOW:4:15", "MINLEN:36"]
      threads: 4

  - step_number: 2
    step_name: "Gene Recovery - Paftools"
    tool_name: "paftools"
    description: "Extract genes from sequencing reads using Paftools"
    input_types: ["FASTQ"]
    output_types: ["FASTA"]
    parameters:
      method: "paftools"
      target_genes: "auto"
      output_format: "fasta"

  - step_number: 3
    step_name: "Gene Recovery - HybPiper (Alternative)"
    tool_name: "hybpiper"
    description: "Extract genes using HybPiper for targeted sequence capture"
    input_types: ["FASTQ"]
    output_types: ["FASTA"]
    parameters:
      method: "hybpiper"
      target_genes: "required"
      output_format: "fasta"
      threads: 4

  - step_number: 4
    step_name: "Sequence Processing"
    tool_name: "seqtk"
    description: "Process and format recovered gene sequences"
    input_types: ["FASTA"]
    output_types: ["FASTA"]
    parameters:
      subcommand: "seq"
      format: "fasta"

# Workflow configuration
workflow_config:
  parallel_execution: false
  error_handling: "stop_on_error"
  resource_requirements:
    memory: "8GB"
    cpu_cores: 4
    storage: "10GB"
  
  # Input validation
  input_validation:
    required_formats: ["FASTQ"]
    min_file_size: "1MB"
    max_file_size: "10GB"
  
  # Output configuration
  output_config:
    create_summary: true
    generate_reports: true
    compress_outputs: false

# Tool dependencies
dependencies:
  - name: "trimmomatic"
    version: "0.39"
    required: true
  - name: "paftools"
    version: "1.0"
    required: true
  - name: "hybpiper"
    version: "1.3.1"
    required: false
  - name: "seqtk"
    version: "1.3"
    required: true

# Example usage
example_usage:
  command: "python manage.py run_workflow gene_recovery_pipeline --input samples/*.fastq --output results/"
  description: "Run gene recovery on all FASTQ files in samples directory"
